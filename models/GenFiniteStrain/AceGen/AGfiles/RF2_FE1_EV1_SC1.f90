!**************************************************************
!* AceGen    6.702 Windows (4 May 16)                         *
!*           Co. J. Korelc  2013           19 Mar 17 15:22:55 *
!**************************************************************
! User     : Full professional version
! Notebook : ResidualFunction
! Evaluation time                 : 8 s     Mode  : Optimal
! Number of formulae              : 158     Method: Automatic
! Subroutine                      : RF2 size: 3662
! Total size of Mathematica  code : 3662 subexpressions
! Total size of Fortran code      : 7931 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE RF2(v,x,props,statev,Fnew,R)
USE SMSUtility
IMPLICIT NONE
LOGICAL b173
DOUBLE PRECISION v(317),x(28),props(12),statev(28),Fnew(9),R(28)
v(287)=props(4)*x(1)
v(280)=x(21)*x(22)-x(24)*x(28)
v(279)=-(x(22)*x(23))+x(26)*x(28)
v(278)=x(23)*x(25)-x(20)*x(28)
v(277)=-(x(21)*x(25))+x(27)*x(28)
v(276)=x(24)*x(25)-x(22)*x(27)
v(275)=-(x(20)*x(24))+x(26)*x(27)
v(274)=x(20)*x(21)-x(23)*x(27)
v(273)=x(20)*x(22)-x(25)*x(26)
v(272)=x(23)*x(24)-x(21)*x(26)
v(271)=x(12)*x(13)-x(15)*x(19)
v(270)=-(x(13)*x(14))+x(17)*x(19)
v(269)=x(14)*x(16)-x(11)*x(19)
v(268)=-(x(12)*x(16))+x(18)*x(19)
v(267)=x(15)*x(16)-x(13)*x(18)
v(266)=-(x(11)*x(15))+x(17)*x(18)
v(265)=x(11)*x(12)-x(14)*x(18)
v(264)=x(11)*x(13)-x(16)*x(17)
v(263)=x(14)*x(15)-x(12)*x(17)
v(262)=x(3)*x(4)-x(10)*x(6)
v(261)=-(x(3)*x(7))+x(10)*x(9)
v(260)=-(x(10)*x(2))+x(5)*x(7)
v(259)=-(x(4)*x(5))+x(10)*x(8)
v(258)=x(6)*x(7)-x(4)*x(9)
v(257)=x(2)*x(3)-x(5)*x(9)
v(256)=-(x(2)*x(6))+x(8)*x(9)
v(255)=x(2)*x(4)-x(7)*x(8)
v(254)=x(5)*x(6)-x(3)*x(8)
v(253)=-statev(1)+x(1)
v(252)=0.15d1*props(6)
v(251)=props(8)*v(252)
v(250)=1d0-props(6)
v(235)=props(11)*v(252)
v(79)=1d0/(v(256)*x(10)+v(257)*x(4)+v(254)*x(7))
v(212)=v(265)*x(13)+v(263)*x(16)+v(266)*x(19)
v(303)=-(v(266)/v(212))
v(302)=-(v(265)/v(212))
v(301)=-(v(263)/v(212))
v(300)=-(v(270)/v(212))
v(299)=-(v(269)/v(212))
v(298)=-(v(264)/v(212))
v(297)=-(v(271)/v(212))
v(296)=-(v(268)/v(212))
v(295)=-(v(267)/v(212))
v(230)=v(274)*x(22)+v(272)*x(25)+v(275)*x(28)
v(312)=-(v(275)/v(230))
v(311)=-(v(274)/v(230))
v(310)=-(v(272)/v(230))
v(309)=-(v(279)/v(230))
v(308)=-(v(278)/v(230))
v(307)=-(v(273)/v(230))
v(306)=-(v(280)/v(230))
v(305)=-(v(277)/v(230))
v(304)=-(v(276)/v(230))
v(78)=v(262)*v(79)
v(80)=v(255)*v(79)
v(81)=v(257)*v(79)
v(82)=v(259)*v(79)
v(83)=v(256)*v(79)
v(84)=v(261)*v(79)
v(85)=v(254)*v(79)
v(86)=v(258)*v(79)
v(87)=v(260)*v(79)
v(88)=Fnew(1)*v(78)+Fnew(7)*v(84)+Fnew(4)*v(86)
v(89)=Fnew(2)*v(80)+Fnew(8)*v(82)+Fnew(5)*v(87)
v(90)=Fnew(3)*v(81)+Fnew(9)*v(83)+Fnew(6)*v(85)
v(91)=Fnew(4)*v(80)+Fnew(1)*v(82)+Fnew(7)*v(87)
v(92)=Fnew(5)*v(81)+Fnew(2)*v(83)+Fnew(8)*v(85)
v(93)=Fnew(6)*v(78)+Fnew(3)*v(84)+Fnew(9)*v(86)
v(94)=Fnew(7)*v(81)+Fnew(4)*v(83)+Fnew(1)*v(85)
v(95)=Fnew(8)*v(78)+Fnew(5)*v(84)+Fnew(2)*v(86)
v(96)=Fnew(9)*v(80)+Fnew(6)*v(82)+Fnew(3)*v(87)
v(97)=(v(88)*v(88))+(v(93)*v(93))+(v(95)*v(95))
v(109)=-v(97)/3d0
v(98)=(v(89)*v(89))+(v(91)*v(91))+(v(96)*v(96))
v(110)=-v(98)/3d0
v(99)=(v(90)*v(90))+(v(92)*v(92))+(v(94)*v(94))
v(105)=-v(99)/3d0
v(100)=v(88)*v(91)+v(89)*v(95)+v(93)*v(96)
v(101)=v(89)*v(92)+v(91)*v(94)+v(90)*v(96)
v(102)=v(90)*v(93)+v(88)*v(94)+v(92)*v(95)
v(103)=2d0*v(100)*v(101)*v(102)-(v(101)*v(101))*v(97)-(v(102)*v(102))*v(98)+(-(v(100)*v(100))+v(97)*v(98))*v(99)
v(107)=props(2)*(v(103)-sqrt(v(103)))
v(106)=1d0/v(103)**0.3333333333333333d0
v(285)=props(1)*v(106)
v(115)=1d0/v(212)**2
v(121)=1d0/v(115)**0.3333333333333333d0
v(281)=props(7)*v(121)
v(282)=v(115)*v(281)
v(116)=v(115)*((v(263)*v(263))+(v(265)*v(265))+(v(266)*v(266)))
v(120)=-v(116)/3d0
v(117)=v(115)*((v(264)*v(264))+(v(269)*v(269))+(v(270)*v(270)))
v(123)=-v(117)/3d0
v(118)=v(115)*((v(267)*v(267))+(v(268)*v(268))+(v(271)*v(271)))
v(124)=-v(118)/3d0
v(119)=((2d0/3d0)*v(118)+v(120)+v(123))*v(281)
v(122)=((2d0/3d0)*v(117)+v(120)+v(124))*v(281)
v(125)=((2d0/3d0)*v(116)+v(123)+v(124))*v(281)
v(133)=(v(264)*v(267)+v(268)*v(269)+v(270)*v(271))*v(282)
v(138)=(v(264)*v(266)+v(265)*v(269)+v(263)*v(270))*v(282)
v(140)=(v(266)*v(267)+v(265)*v(268)+v(263)*v(271))*v(282)
v(141)=1d0/v(230)**2
v(147)=1d0/v(141)**0.3333333333333333d0
v(283)=props(10)*v(147)
v(284)=v(141)*v(283)
v(142)=v(141)*((v(272)*v(272))+(v(274)*v(274))+(v(275)*v(275)))
v(146)=-v(142)/3d0
v(143)=v(141)*((v(273)*v(273))+(v(278)*v(278))+(v(279)*v(279)))
v(149)=-v(143)/3d0
v(144)=v(141)*((v(276)*v(276))+(v(277)*v(277))+(v(280)*v(280)))
v(150)=-v(144)/3d0
v(145)=((2d0/3d0)*v(144)+v(146)+v(149))*v(283)
v(148)=((2d0/3d0)*v(143)+v(146)+v(150))*v(283)
v(151)=((2d0/3d0)*v(142)+v(149)+v(150))*v(283)
v(159)=(v(273)*v(276)+v(277)*v(278)+v(279)*v(280))*v(284)
v(164)=(v(273)*v(275)+v(274)*v(278)+v(272)*v(279))*v(284)
v(166)=(v(275)*v(276)+v(274)*v(277)+v(272)*v(280))*v(284)
v(167)=v(107)-v(119)-v(145)+v(285)*(v(105)+v(110)+(2d0/3d0)*v(97))
v(168)=v(107)-v(122)-v(148)+v(285)*(v(105)+v(109)+(2d0/3d0)*v(98))
v(169)=v(107)-v(125)-v(151)+v(285)*(v(109)+v(110)+(2d0/3d0)*v(99))
v(170)=-v(133)-v(159)+v(100)*v(285)
v(171)=-v(138)-v(164)+v(101)*v(285)
v(172)=-v(140)-v(166)+v(102)*v(285)
IF(dabs(props(5)).lt.0.1d-11) THEN
 v(286)=v(287)
 v(174)=v(286)
ELSE
 v(288)=1d0/props(5)
 v(174)=v(288)*(1d0-dexp(-(props(5)*v(287))))
ENDIF
v(182)=1d0/(props(3)+v(174))
v(289)=0.15d1*v(182)
v(175)=-v(168)/3d0
v(176)=-v(169)/3d0
v(179)=(2d0/3d0)*v(167)+v(175)+v(176)
v(177)=-v(167)/3d0
v(184)=(2d0/3d0)*v(169)+v(175)+v(177)
v(181)=(2d0/3d0)*v(168)+v(176)+v(177)
v(180)=v(179)*v(289)
v(183)=v(181)*v(289)
v(185)=v(184)*v(289)
v(186)=v(170)*v(289)
v(291)=2d0*v(186)
v(208)=-(v(186)*v(253))
v(187)=v(171)*v(289)
v(292)=2d0*v(187)
v(210)=-(v(187)*v(253))
v(188)=v(172)*v(289)
v(293)=2d0*v(188)
v(236)=props(11)*v(250)*(v(145)*v(180)+v(148)*v(183)+v(151)*v(185)+v(159)*v(291)+v(164)*v(292)+v(166)*v(293))
v(290)=(-1d0)+v(236)
v(247)=-(v(253)*(v(164)*v(235)+v(187)*v(290)))
v(245)=-(v(253)*(v(159)*v(235)+v(186)*v(290)))
v(243)=-(v(253)*(v(166)*v(235)+v(188)*v(290)))
v(217)=props(8)*v(250)*(v(119)*v(180)+v(122)*v(183)+v(125)*v(185)+v(133)*v(291)+v(138)*v(292)+v(140)*v(293))
v(294)=(-1d0)+v(217)
v(228)=-(v(253)*(v(138)*v(251)+v(187)*v(294)))
v(226)=-(v(253)*(v(133)*v(251)+v(186)*v(294)))
v(224)=-(v(253)*(v(140)*v(251)+v(188)*v(294)))
v(206)=-(v(188)*v(253))
R(1)=-props(3)-v(174)+sqrt(0.15d1*(2d0*v(170)**2+2d0*v(171)**2+2d0*v(172)**2+v(179)**2+v(181)**2+v(184)**2))
R(2)=1d0-v(180)*v(253)+(-(statev(5)*v(258))-statev(8)*v(261)-statev(2)*v(262))*v(79)
R(3)=1d0-v(183)*v(253)+(-(statev(3)*v(255))-statev(9)*v(259)-statev(6)*v(260))*v(79)
R(4)=1d0-v(185)*v(253)+(-(statev(7)*v(254))-statev(10)*v(256)-statev(4)*v(257))*v(79)
R(5)=v(208)+(-(statev(5)*v(255))-statev(2)*v(259)-statev(8)*v(260))*v(79)
R(6)=v(210)+(-(statev(9)*v(254))-statev(3)*v(256)-statev(6)*v(257))*v(79)
R(7)=v(206)+(-(statev(10)*v(258))-statev(4)*v(261)-statev(7)*v(262))*v(79)
R(8)=v(206)+(-(statev(2)*v(254))-statev(5)*v(256)-statev(8)*v(257))*v(79)
R(9)=v(208)+(-(statev(3)*v(258))-statev(6)*v(261)-statev(9)*v(262))*v(79)
R(10)=v(210)+(-(statev(10)*v(255))-statev(7)*v(259)-statev(4)*v(260))*v(79)
R(11)=1d0-v(253)*(v(119)*v(251)+v(180)*v(294))+statev(14)*v(295)+statev(17)*v(296)+statev(11)*v(297)
R(12)=1d0-v(253)*(v(122)*v(251)+v(183)*v(294))+statev(12)*v(298)+statev(15)*v(299)+statev(18)*v(300)
R(13)=1d0-v(253)*(v(125)*v(251)+v(185)*v(294))+statev(16)*v(301)+statev(13)*v(302)+statev(19)*v(303)
R(14)=v(226)+statev(14)*v(298)+statev(17)*v(299)+statev(11)*v(300)
R(15)=v(228)+statev(18)*v(301)+statev(15)*v(302)+statev(12)*v(303)
R(16)=v(224)+statev(19)*v(295)+statev(13)*v(296)+statev(16)*v(297)
R(17)=v(224)+statev(11)*v(301)+statev(17)*v(302)+statev(14)*v(303)
R(18)=v(226)+statev(12)*v(295)+statev(15)*v(296)+statev(18)*v(297)
R(19)=v(228)+statev(19)*v(298)+statev(13)*v(299)+statev(16)*v(300)
R(20)=1d0-v(253)*(v(145)*v(235)+v(180)*v(290))+statev(23)*v(304)+statev(26)*v(305)+statev(20)*v(306)
R(21)=1d0-v(253)*(v(148)*v(235)+v(183)*v(290))+statev(21)*v(307)+statev(24)*v(308)+statev(27)*v(309)
R(22)=1d0-v(253)*(v(151)*v(235)+v(185)*v(290))+statev(25)*v(310)+statev(22)*v(311)+statev(28)*v(312)
R(23)=v(245)+statev(23)*v(307)+statev(26)*v(308)+statev(20)*v(309)
R(24)=v(247)+statev(27)*v(310)+statev(24)*v(311)+statev(21)*v(312)
R(25)=v(243)+statev(28)*v(304)+statev(22)*v(305)+statev(25)*v(306)
R(26)=v(243)+statev(20)*v(310)+statev(26)*v(311)+statev(23)*v(312)
R(27)=v(245)+statev(21)*v(304)+statev(24)*v(305)+statev(27)*v(306)
R(28)=v(247)+statev(28)*v(307)+statev(22)*v(308)+statev(25)*v(309)
END
