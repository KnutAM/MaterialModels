!**************************************************************
!* AceGen    6.702 Windows (4 May 16)                         *
!*           Co. J. Korelc  2013           19 Mar 17 15:23:33 *
!**************************************************************
! User     : Full professional version
! Notebook : ResidualFunction
! Evaluation time                 : 15 s    Mode  : Optimal
! Number of formulae              : 240     Method: Automatic
! Subroutine                      : RF4 size: 5790
! Total size of Mathematica  code : 5790 subexpressions
! Total size of Fortran code      : 12570 bytes

!******************* S U B R O U T I N E **********************
SUBROUTINE RF4(v,x,props,statev,Fnew,R)
USE SMSUtility
IMPLICIT NONE
LOGICAL b267
DOUBLE PRECISION v(489),x(46),props(18),statev(46),Fnew(9),R(46)
v(439)=props(4)*x(1)
v(428)=x(39)*x(40)-x(42)*x(46)
v(427)=-(x(40)*x(41))+x(44)*x(46)
v(426)=x(41)*x(43)-x(38)*x(46)
v(425)=-(x(39)*x(43))+x(45)*x(46)
v(424)=x(42)*x(43)-x(40)*x(45)
v(423)=-(x(38)*x(42))+x(44)*x(45)
v(422)=x(38)*x(39)-x(41)*x(45)
v(421)=x(38)*x(40)-x(43)*x(44)
v(420)=x(41)*x(42)-x(39)*x(44)
v(419)=x(30)*x(31)-x(33)*x(37)
v(418)=-(x(31)*x(32))+x(35)*x(37)
v(417)=x(32)*x(34)-x(29)*x(37)
v(416)=-(x(30)*x(34))+x(36)*x(37)
v(415)=x(33)*x(34)-x(31)*x(36)
v(414)=-(x(29)*x(33))+x(35)*x(36)
v(413)=x(29)*x(30)-x(32)*x(36)
v(412)=x(29)*x(31)-x(34)*x(35)
v(411)=x(32)*x(33)-x(30)*x(35)
v(410)=x(21)*x(22)-x(24)*x(28)
v(409)=-(x(22)*x(23))+x(26)*x(28)
v(408)=x(23)*x(25)-x(20)*x(28)
v(407)=-(x(21)*x(25))+x(27)*x(28)
v(406)=x(24)*x(25)-x(22)*x(27)
v(405)=-(x(20)*x(24))+x(26)*x(27)
v(404)=x(20)*x(21)-x(23)*x(27)
v(403)=x(20)*x(22)-x(25)*x(26)
v(402)=x(23)*x(24)-x(21)*x(26)
v(401)=x(12)*x(13)-x(15)*x(19)
v(400)=-(x(13)*x(14))+x(17)*x(19)
v(399)=x(14)*x(16)-x(11)*x(19)
v(398)=-(x(12)*x(16))+x(18)*x(19)
v(397)=x(15)*x(16)-x(13)*x(18)
v(396)=-(x(11)*x(15))+x(17)*x(18)
v(395)=x(11)*x(12)-x(14)*x(18)
v(394)=x(11)*x(13)-x(16)*x(17)
v(393)=x(14)*x(15)-x(12)*x(17)
v(392)=x(3)*x(4)-x(10)*x(6)
v(391)=-(x(3)*x(7))+x(10)*x(9)
v(390)=-(x(10)*x(2))+x(5)*x(7)
v(389)=-(x(4)*x(5))+x(10)*x(8)
v(388)=x(6)*x(7)-x(4)*x(9)
v(387)=x(2)*x(3)-x(5)*x(9)
v(386)=-(x(2)*x(6))+x(8)*x(9)
v(385)=x(2)*x(4)-x(7)*x(8)
v(384)=x(5)*x(6)-x(3)*x(8)
v(383)=-statev(1)+x(1)
v(382)=0.15d1*props(6)
v(381)=props(8)*v(382)
v(380)=1d0-props(6)
v(329)=props(11)*v(382)
v(347)=props(14)*v(382)
v(365)=props(17)*v(382)
v(121)=1d0/(v(386)*x(10)+v(387)*x(4)+v(384)*x(7))
v(306)=v(395)*x(13)+v(393)*x(16)+v(396)*x(19)
v(457)=-(v(396)/v(306))
v(456)=-(v(395)/v(306))
v(455)=-(v(393)/v(306))
v(454)=-(v(400)/v(306))
v(453)=-(v(399)/v(306))
v(452)=-(v(394)/v(306))
v(451)=-(v(401)/v(306))
v(450)=-(v(398)/v(306))
v(449)=-(v(397)/v(306))
v(324)=v(404)*x(22)+v(402)*x(25)+v(405)*x(28)
v(466)=-(v(405)/v(324))
v(465)=-(v(404)/v(324))
v(464)=-(v(402)/v(324))
v(463)=-(v(409)/v(324))
v(462)=-(v(408)/v(324))
v(461)=-(v(403)/v(324))
v(460)=-(v(410)/v(324))
v(459)=-(v(407)/v(324))
v(458)=-(v(406)/v(324))
v(343)=v(413)*x(31)+v(411)*x(34)+v(414)*x(37)
v(475)=-(v(414)/v(343))
v(474)=-(v(413)/v(343))
v(473)=-(v(411)/v(343))
v(472)=-(v(418)/v(343))
v(471)=-(v(417)/v(343))
v(470)=-(v(412)/v(343))
v(469)=-(v(419)/v(343))
v(468)=-(v(416)/v(343))
v(467)=-(v(415)/v(343))
v(361)=v(422)*x(40)+v(420)*x(43)+v(423)*x(46)
v(484)=-(v(423)/v(361))
v(483)=-(v(422)/v(361))
v(482)=-(v(420)/v(361))
v(481)=-(v(427)/v(361))
v(480)=-(v(426)/v(361))
v(479)=-(v(421)/v(361))
v(478)=-(v(428)/v(361))
v(477)=-(v(425)/v(361))
v(476)=-(v(424)/v(361))
v(120)=v(121)*v(392)
v(122)=v(121)*v(385)
v(123)=v(121)*v(387)
v(124)=v(121)*v(389)
v(125)=v(121)*v(386)
v(126)=v(121)*v(391)
v(127)=v(121)*v(384)
v(128)=v(121)*v(388)
v(129)=v(121)*v(390)
v(130)=Fnew(1)*v(120)+Fnew(7)*v(126)+Fnew(4)*v(128)
v(131)=Fnew(2)*v(122)+Fnew(8)*v(124)+Fnew(5)*v(129)
v(132)=Fnew(3)*v(123)+Fnew(9)*v(125)+Fnew(6)*v(127)
v(133)=Fnew(4)*v(122)+Fnew(1)*v(124)+Fnew(7)*v(129)
v(134)=Fnew(5)*v(123)+Fnew(2)*v(125)+Fnew(8)*v(127)
v(135)=Fnew(6)*v(120)+Fnew(3)*v(126)+Fnew(9)*v(128)
v(136)=Fnew(7)*v(123)+Fnew(4)*v(125)+Fnew(1)*v(127)
v(137)=Fnew(8)*v(120)+Fnew(5)*v(126)+Fnew(2)*v(128)
v(138)=Fnew(9)*v(122)+Fnew(6)*v(124)+Fnew(3)*v(129)
v(139)=(v(130)*v(130))+(v(135)*v(135))+(v(137)*v(137))
v(151)=-v(139)/3d0
v(140)=(v(131)*v(131))+(v(133)*v(133))+(v(138)*v(138))
v(152)=-v(140)/3d0
v(141)=(v(132)*v(132))+(v(134)*v(134))+(v(136)*v(136))
v(147)=-v(141)/3d0
v(142)=v(130)*v(133)+v(131)*v(137)+v(135)*v(138)
v(143)=v(131)*v(134)+v(133)*v(136)+v(132)*v(138)
v(144)=v(132)*v(135)+v(130)*v(136)+v(134)*v(137)
v(145)=v(141)*(v(139)*v(140)-(v(142)*v(142)))-v(139)*(v(143)*v(143))+2d0*v(142)*v(143)*v(144)-v(140)*(v(144)*v(144))
v(149)=props(2)*(v(145)-sqrt(v(145)))
v(148)=1d0/v(145)**0.3333333333333333d0
v(437)=props(1)*v(148)
v(157)=1d0/v(306)**2
v(163)=1d0/v(157)**0.3333333333333333d0
v(429)=props(7)*v(163)
v(430)=v(157)*v(429)
v(158)=v(157)*((v(393)*v(393))+(v(395)*v(395))+(v(396)*v(396)))
v(162)=-v(158)/3d0
v(159)=v(157)*((v(394)*v(394))+(v(399)*v(399))+(v(400)*v(400)))
v(165)=-v(159)/3d0
v(160)=v(157)*((v(397)*v(397))+(v(398)*v(398))+(v(401)*v(401)))
v(166)=-v(160)/3d0
v(161)=((2d0/3d0)*v(160)+v(162)+v(165))*v(429)
v(164)=((2d0/3d0)*v(159)+v(162)+v(166))*v(429)
v(167)=((2d0/3d0)*v(158)+v(165)+v(166))*v(429)
v(175)=(v(394)*v(397)+v(398)*v(399)+v(400)*v(401))*v(430)
v(180)=(v(394)*v(396)+v(395)*v(399)+v(393)*v(400))*v(430)
v(182)=(v(396)*v(397)+v(395)*v(398)+v(393)*v(401))*v(430)
v(183)=1d0/v(324)**2
v(189)=1d0/v(183)**0.3333333333333333d0
v(431)=props(10)*v(189)
v(432)=v(183)*v(431)
v(184)=v(183)*((v(402)*v(402))+(v(404)*v(404))+(v(405)*v(405)))
v(188)=-v(184)/3d0
v(185)=v(183)*((v(403)*v(403))+(v(408)*v(408))+(v(409)*v(409)))
v(191)=-v(185)/3d0
v(186)=v(183)*((v(406)*v(406))+(v(407)*v(407))+(v(410)*v(410)))
v(192)=-v(186)/3d0
v(187)=((2d0/3d0)*v(186)+v(188)+v(191))*v(431)
v(190)=((2d0/3d0)*v(185)+v(188)+v(192))*v(431)
v(193)=((2d0/3d0)*v(184)+v(191)+v(192))*v(431)
v(201)=(v(403)*v(406)+v(407)*v(408)+v(409)*v(410))*v(432)
v(206)=(v(403)*v(405)+v(404)*v(408)+v(402)*v(409))*v(432)
v(208)=(v(405)*v(406)+v(404)*v(407)+v(402)*v(410))*v(432)
v(209)=1d0/v(343)**2
v(215)=1d0/v(209)**0.3333333333333333d0
v(433)=props(13)*v(215)
v(434)=v(209)*v(433)
v(210)=v(209)*((v(411)*v(411))+(v(413)*v(413))+(v(414)*v(414)))
v(214)=-v(210)/3d0
v(211)=v(209)*((v(412)*v(412))+(v(417)*v(417))+(v(418)*v(418)))
v(217)=-v(211)/3d0
v(212)=v(209)*((v(415)*v(415))+(v(416)*v(416))+(v(419)*v(419)))
v(218)=-v(212)/3d0
v(213)=((2d0/3d0)*v(212)+v(214)+v(217))*v(433)
v(216)=((2d0/3d0)*v(211)+v(214)+v(218))*v(433)
v(219)=((2d0/3d0)*v(210)+v(217)+v(218))*v(433)
v(227)=(v(412)*v(415)+v(416)*v(417)+v(418)*v(419))*v(434)
v(232)=(v(412)*v(414)+v(413)*v(417)+v(411)*v(418))*v(434)
v(234)=(v(414)*v(415)+v(413)*v(416)+v(411)*v(419))*v(434)
v(235)=1d0/v(361)**2
v(241)=1d0/v(235)**0.3333333333333333d0
v(435)=props(16)*v(241)
v(436)=v(235)*v(435)
v(236)=v(235)*((v(420)*v(420))+(v(422)*v(422))+(v(423)*v(423)))
v(240)=-v(236)/3d0
v(237)=v(235)*((v(421)*v(421))+(v(426)*v(426))+(v(427)*v(427)))
v(243)=-v(237)/3d0
v(238)=v(235)*((v(424)*v(424))+(v(425)*v(425))+(v(428)*v(428)))
v(244)=-v(238)/3d0
v(239)=((2d0/3d0)*v(238)+v(240)+v(243))*v(435)
v(242)=((2d0/3d0)*v(237)+v(240)+v(244))*v(435)
v(245)=((2d0/3d0)*v(236)+v(243)+v(244))*v(435)
v(253)=(v(421)*v(424)+v(425)*v(426)+v(427)*v(428))*v(436)
v(258)=(v(421)*v(423)+v(422)*v(426)+v(420)*v(427))*v(436)
v(260)=(v(423)*v(424)+v(422)*v(425)+v(420)*v(428))*v(436)
v(261)=v(149)-v(161)-v(187)-v(213)-v(239)+((2d0/3d0)*v(139)+v(147)+v(152))*v(437)
v(262)=v(149)-v(164)-v(190)-v(216)-v(242)+((2d0/3d0)*v(140)+v(147)+v(151))*v(437)
v(263)=v(149)-v(167)-v(193)-v(219)-v(245)+((2d0/3d0)*v(141)+v(151)+v(152))*v(437)
v(264)=-v(175)-v(201)-v(227)-v(253)+v(142)*v(437)
v(265)=-v(180)-v(206)-v(232)-v(258)+v(143)*v(437)
v(266)=-v(182)-v(208)-v(234)-v(260)+v(144)*v(437)
IF(dabs(props(5)).lt.0.1d-11) THEN
 v(438)=v(439)
 v(268)=v(438)
ELSE
 v(440)=1d0/props(5)
 v(268)=v(440)*(1d0-dexp(-(props(5)*v(439))))
ENDIF
v(276)=1d0/(props(3)+v(268))
v(441)=0.15d1*v(276)
v(269)=-v(262)/3d0
v(270)=-v(263)/3d0
v(273)=(2d0/3d0)*v(261)+v(269)+v(270)
v(271)=-v(261)/3d0
v(278)=(2d0/3d0)*v(263)+v(269)+v(271)
v(275)=(2d0/3d0)*v(262)+v(270)+v(271)
v(274)=v(273)*v(441)
v(277)=v(275)*v(441)
v(279)=v(278)*v(441)
v(280)=v(264)*v(441)
v(443)=2d0*v(280)
v(302)=-(v(280)*v(383))
v(281)=v(265)*v(441)
v(444)=2d0*v(281)
v(304)=-(v(281)*v(383))
v(282)=v(266)*v(441)
v(445)=2d0*v(282)
v(366)=props(17)*v(380)*(v(239)*v(274)+v(242)*v(277)+v(245)*v(279)+v(253)*v(443)+v(258)*v(444)+v(260)*v(445))
v(442)=(-1d0)+v(366)
v(377)=-(v(383)*(v(258)*v(365)+v(281)*v(442)))
v(375)=-(v(383)*(v(253)*v(365)+v(280)*v(442)))
v(373)=-(v(383)*(v(260)*v(365)+v(282)*v(442)))
v(348)=props(14)*v(380)*(v(213)*v(274)+v(216)*v(277)+v(219)*v(279)+v(227)*v(443)+v(232)*v(444)+v(234)*v(445))
v(446)=(-1d0)+v(348)
v(359)=-(v(383)*(v(232)*v(347)+v(281)*v(446)))
v(357)=-(v(383)*(v(227)*v(347)+v(280)*v(446)))
v(355)=-(v(383)*(v(234)*v(347)+v(282)*v(446)))
v(330)=props(11)*v(380)*(v(187)*v(274)+v(190)*v(277)+v(193)*v(279)+v(201)*v(443)+v(206)*v(444)+v(208)*v(445))
v(447)=(-1d0)+v(330)
v(341)=-(v(383)*(v(206)*v(329)+v(281)*v(447)))
v(339)=-(v(383)*(v(201)*v(329)+v(280)*v(447)))
v(337)=-(v(383)*(v(208)*v(329)+v(282)*v(447)))
v(311)=props(8)*v(380)*(v(161)*v(274)+v(164)*v(277)+v(167)*v(279)+v(175)*v(443)+v(180)*v(444)+v(182)*v(445))
v(448)=(-1d0)+v(311)
v(322)=-(v(383)*(v(180)*v(381)+v(281)*v(448)))
v(320)=-(v(383)*(v(175)*v(381)+v(280)*v(448)))
v(318)=-(v(383)*(v(182)*v(381)+v(282)*v(448)))
v(300)=-(v(282)*v(383))
R(1)=-props(3)-v(268)+sqrt(0.15d1*(2d0*v(264)**2+2d0*v(265)**2+2d0*v(266)**2+v(273)**2+v(275)**2+v(278)**2))
R(2)=1d0-v(274)*v(383)+v(121)*(-(statev(5)*v(388))-statev(8)*v(391)-statev(2)*v(392))
R(3)=1d0-v(277)*v(383)+v(121)*(-(statev(3)*v(385))-statev(9)*v(389)-statev(6)*v(390))
R(4)=1d0-v(279)*v(383)+v(121)*(-(statev(7)*v(384))-statev(10)*v(386)-statev(4)*v(387))
R(5)=v(302)+v(121)*(-(statev(5)*v(385))-statev(2)*v(389)-statev(8)*v(390))
R(6)=v(304)+v(121)*(-(statev(9)*v(384))-statev(3)*v(386)-statev(6)*v(387))
R(7)=v(300)+v(121)*(-(statev(10)*v(388))-statev(4)*v(391)-statev(7)*v(392))
R(8)=v(300)+v(121)*(-(statev(2)*v(384))-statev(5)*v(386)-statev(8)*v(387))
R(9)=v(302)+v(121)*(-(statev(3)*v(388))-statev(6)*v(391)-statev(9)*v(392))
R(10)=v(304)+v(121)*(-(statev(10)*v(385))-statev(7)*v(389)-statev(4)*v(390))
R(11)=1d0-v(383)*(v(161)*v(381)+v(274)*v(448))+statev(14)*v(449)+statev(17)*v(450)+statev(11)*v(451)
R(12)=1d0-v(383)*(v(164)*v(381)+v(277)*v(448))+statev(12)*v(452)+statev(15)*v(453)+statev(18)*v(454)
R(13)=1d0-v(383)*(v(167)*v(381)+v(279)*v(448))+statev(16)*v(455)+statev(13)*v(456)+statev(19)*v(457)
R(14)=v(320)+statev(14)*v(452)+statev(17)*v(453)+statev(11)*v(454)
R(15)=v(322)+statev(18)*v(455)+statev(15)*v(456)+statev(12)*v(457)
R(16)=v(318)+statev(19)*v(449)+statev(13)*v(450)+statev(16)*v(451)
R(17)=v(318)+statev(11)*v(455)+statev(17)*v(456)+statev(14)*v(457)
R(18)=v(320)+statev(12)*v(449)+statev(15)*v(450)+statev(18)*v(451)
R(19)=v(322)+statev(19)*v(452)+statev(13)*v(453)+statev(16)*v(454)
R(20)=1d0-v(383)*(v(187)*v(329)+v(274)*v(447))+statev(23)*v(458)+statev(26)*v(459)+statev(20)*v(460)
R(21)=1d0-v(383)*(v(190)*v(329)+v(277)*v(447))+statev(21)*v(461)+statev(24)*v(462)+statev(27)*v(463)
R(22)=1d0-v(383)*(v(193)*v(329)+v(279)*v(447))+statev(25)*v(464)+statev(22)*v(465)+statev(28)*v(466)
R(23)=v(339)+statev(23)*v(461)+statev(26)*v(462)+statev(20)*v(463)
R(24)=v(341)+statev(27)*v(464)+statev(24)*v(465)+statev(21)*v(466)
R(25)=v(337)+statev(28)*v(458)+statev(22)*v(459)+statev(25)*v(460)
R(26)=v(337)+statev(20)*v(464)+statev(26)*v(465)+statev(23)*v(466)
R(27)=v(339)+statev(21)*v(458)+statev(24)*v(459)+statev(27)*v(460)
R(28)=v(341)+statev(28)*v(461)+statev(22)*v(462)+statev(25)*v(463)
R(29)=1d0-v(383)*(v(213)*v(347)+v(274)*v(446))+statev(32)*v(467)+statev(35)*v(468)+statev(29)*v(469)
R(30)=1d0-v(383)*(v(216)*v(347)+v(277)*v(446))+statev(30)*v(470)+statev(33)*v(471)+statev(36)*v(472)
R(31)=1d0-v(383)*(v(219)*v(347)+v(279)*v(446))+statev(34)*v(473)+statev(31)*v(474)+statev(37)*v(475)
R(32)=v(357)+statev(32)*v(470)+statev(35)*v(471)+statev(29)*v(472)
R(33)=v(359)+statev(36)*v(473)+statev(33)*v(474)+statev(30)*v(475)
R(34)=v(355)+statev(37)*v(467)+statev(31)*v(468)+statev(34)*v(469)
R(35)=v(355)+statev(29)*v(473)+statev(35)*v(474)+statev(32)*v(475)
R(36)=v(357)+statev(30)*v(467)+statev(33)*v(468)+statev(36)*v(469)
R(37)=v(359)+statev(37)*v(470)+statev(31)*v(471)+statev(34)*v(472)
R(38)=1d0-v(383)*(v(239)*v(365)+v(274)*v(442))+statev(41)*v(476)+statev(44)*v(477)+statev(38)*v(478)
R(39)=1d0-v(383)*(v(242)*v(365)+v(277)*v(442))+statev(39)*v(479)+statev(42)*v(480)+statev(45)*v(481)
R(40)=1d0-v(383)*(v(245)*v(365)+v(279)*v(442))+statev(43)*v(482)+statev(40)*v(483)+statev(46)*v(484)
R(41)=v(375)+statev(41)*v(479)+statev(44)*v(480)+statev(38)*v(481)
R(42)=v(377)+statev(45)*v(482)+statev(42)*v(483)+statev(39)*v(484)
R(43)=v(373)+statev(46)*v(476)+statev(40)*v(477)+statev(43)*v(478)
R(44)=v(373)+statev(38)*v(482)+statev(44)*v(483)+statev(41)*v(484)
R(45)=v(375)+statev(39)*v(476)+statev(42)*v(477)+statev(45)*v(478)
R(46)=v(377)+statev(46)*v(479)+statev(40)*v(480)+statev(43)*v(481)
END
